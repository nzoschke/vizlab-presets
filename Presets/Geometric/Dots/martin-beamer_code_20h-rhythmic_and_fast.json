{"version":2,"baseVals":{"rating":5,"gammaadj":1.98,"decay":0.5,"echo_zoom":1,"echo_alpha":0.5,"echo_orient":3,"additivewave":1,"wave_thick":1,"modwavealphabyvolume":1,"darken":1,"wave_a":0.005,"wave_scale":0.118,"wave_smoothing":0.9,"wave_mystery":-0.48,"modwavealphastart":0.4,"modwavealphaend":1.6,"warpanimspeed":1.459,"warpscale":2.007,"zoom":0.9999,"warp":0.01,"sx":0.9999,"wave_r":0.8,"wave_g":0.49,"ob_size":0,"ob_a":1,"ib_size":0.26,"mv_x":64,"mv_y":48,"mv_l":1.85,"mv_r":0.5,"mv_g":0.5,"mv_b":0.5,"mv_a":0,"b1ed":0},"shapes":[{"baseVals":{"enabled":1,"sides":12,"additive":1,"thickoutline":1,"num_inst":64,"rad":0.06598,"tex_ang":1.00531,"tex_zoom":0.12726,"g":1,"b":1,"r2":1,"b2":1,"a2":0.5,"border_a":0},"init_eqs_str":"a.copies=0;a.recsize=0;a.n=0;a.frac=0;a.q32=0;","frame_eqs_str":"a.copies=8;a.recsize=a.reg01;a.n=Math.floor(div(a.instance,a.copies))*a.recsize;a.frac=div(mod(a.instance,a.copies),a.copies);a.x=a.gmegabuf[Math.floor(a.n)]*a.frac+(1-a.frac)*a.megabuf[Math.floor(a.n)];a.y=a.gmegabuf[Math.floor(a.n+1)]*a.frac+(1-a.frac)*a.megabuf[Math.floor(a.n+1)];.00001<Math.abs(.00001>Math.abs(mod(a.instance,a.copies)-(a.copies-1))?1:0)?(a.megabuf[Math.floor(a.n)]=a.gmegabuf[Math.floor(a.n)],a.megabuf[Math.floor(a.n+1)]=a.gmegabuf[Math.floor(a.n+1)]):0;\na.rad=.03*a.q32;a.a=div(a.gmegabuf[Math.floor(a.n+4)]*(1-.5*(1-a.frac)),2);a.a2=a.a;","init_eqs_eel":"","frame_eqs_eel":"copies = 8;\nrecsize    = reg01;\nn = int(instance/copies)*recsize;\nfrac = (instance%copies)/copies;\n\nx = gmegabuf (n)   * frac + (1-frac) * megabuf(n);\ny = gmegabuf (n+1) * frac + (1-frac) * megabuf(n+1);\n\n\nif (instance % copies == copies-1,\n  megabuf (n)   = gmegabuf(n);\n  megabuf (n+1) = gmegabuf (n+1);\n,0);\n\n\nrad = 0.03 * q32;\na = gmegabuf(n+4) * (1-(1-frac)*0.5)/2;\na2 = a;"},{"baseVals":{"sides":14,"additive":1,"num_inst":11,"x":0.26,"y":0.2,"rad":0.07243,"tex_zoom":0.9355,"g":1,"b":1,"r2":1,"b2":1,"a2":1,"border_g":0,"border_b":0,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"x = (q7%16)/16;\ny = instance / 8;\n\nif (instance%2==0, x = 1-x,0);\n\n//x = sin(3.1416/8*(q7+instance))/3+0.5;\n//y = sin(3.1416/9*(q7+instance))/3+0.5;","init_eqs_eel":"","frame_eqs_eel":"x = (q7%16)/16;\ny = instance / 8;\n\nif (instance%2==0, x = 1-x,0);\n\n//x = sin(3.1416/8*(q7+instance))/3+0.5;\n//y = sin(3.1416/9*(q7+instance))/3+0.5;"},{"baseVals":{"num_inst":200,"x":0.65,"y":0.38,"rad":0.1564,"tex_zoom":0.73678,"g":1,"b":1,"a":0.7,"r2":1,"b2":1,"border_r":0.5,"border_g":0.5,"border_b":0,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"x = instance / num_inst * 0.96 + 0.02;\nx = 0.02 + gmegabuf(8*instance+5000)*0.96/320;\ny0 = gmegabuf(8*instance + 4+5000) * 0.3; \ny = 0.05 + y0;\n\nrad = 0.015; border_a = 0.8; b = 0;\nif (q11==instance,rad = 0.05; a = q1;a2 = a; ; b2 = 1;,0);\n\n","init_eqs_eel":"","frame_eqs_eel":"x = instance / num_inst * 0.96 + 0.02;\nx = 0.02 + gmegabuf(8*instance+5000)*0.96/320;\ny0 = gmegabuf(8*instance + 4+5000) * 0.3; \ny = 0.05 + y0;\n\nrad = 0.015; border_a = 0.8; b = 0;\nif (q11==instance,rad = 0.05; a = q1;a2 = a; ; b2 = 1;,0);\n\n"},{"baseVals":{"additive":1,"thickoutline":1,"textured":1,"x":0.6,"y":0.55,"rad":0.17915,"tex_zoom":1.04372,"g":1,"b2":1,"a2":1,"border_g":0.8,"border_b":0.5,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"a = 0; a2 = 0;\nborder_a = 1;","init_eqs_eel":"","frame_eqs_eel":"a = 0; a2 = 0;\nborder_a = 1;"}],"waves":[{"baseVals":{"samples":64,"spectrum":1,"thick":1,"additive":1,"scaling":17.41885,"smoothing":0.2,"a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"t1 = 0;\nt2 = 0;\nt3 = 0;","point_eqs_str":"instance = t1;copies = 1;\nrecsize    = reg01;\nn = int(instance/copies)*recsize;\nfrac = (instance%copies)/copies;\n\nx = gmegabuf (n)   * frac + (1-frac) * megabuf(n);\ny = ((gmegabuf (n+1)-0.5)/q32+0.5) * frac + (1-frac) * megabuf(n+1);\n\n\nif (instance % copies == copies-1,\n  megabuf (n)   = gmegabuf(n);\n  megabuf (n+1) = (gmegabuf (n+1)-0.5)/q32+0.5;\n,0);\n\n\nrad = 0.04 * q32;\na = gmegabuf(n+4) * (1-(1-frac)*0.5) * (t1 < 7)/2;\nt1 += 1;","init_eqs_eel":"","frame_eqs_eel":"t1 = 0;\nt2 = 0;\nt3 = 0;","point_eqs_eel":"instance = t1;copies = 1;\nrecsize    = reg01;\nn = int(instance/copies)*recsize;\nfrac = (instance%copies)/copies;\n\nx = gmegabuf (n)   * frac + (1-frac) * megabuf(n);\ny = ((gmegabuf (n+1)-0.5)/q32+0.5) * frac + (1-frac) * megabuf(n+1);\n\n\nif (instance % copies == copies-1,\n  megabuf (n)   = gmegabuf(n);\n  megabuf (n+1) = (gmegabuf (n+1)-0.5)/q32+0.5;\n,0);\n\n\nrad = 0.04 * q32;\na = gmegabuf(n+4) * (1-(1-frac)*0.5) * (t1 < 7)/2;\nt1 += 1;"},{"baseVals":{"samples":128,"scaling":0.89152,"smoothing":0.82,"a":0.1,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""},{"baseVals":{"samples":32,"scaling":0.89152,"smoothing":0.82,"r":0,"g":0.2,"b":0.6,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""},{"baseVals":{"spectrum":1,"usedots":1,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""}],"init_eqs_str":"a.ind2=0;a.n=0;a.maxbpm=0;a.n2=0;a.num_res=0;a.ran4=0;a.prog2=0;a.ratio=0;a.index=0;a.arg=0;a.is_beat1=0;a.t1=0;a.scale=0;a.q15=0;a.dt=0;a.q1=0;a.ran1_=0;a.oldind=0;a.x=0;a.dec_s=0;a.reg01=0;a.minbpm=0;a.push=0;a.tog2=0;a.maxind=0;a.corr=0;a.omega=0;a.tog1=0;a.ec_steps=0;a.hyst=0;a.k1=0;a.ran2=0;a.pi=0;a.ran4_=0;a.ran3=0;a.num_shapes=0;a.fastpace=0;a.dec_m=0;a.is_beat2=0;a.trunner=0;a.sbeat2=0;a.sig2=0;a.schange=0;a.sum_res=0;a.q16=0;a.prog3=0;a.prog1=0;a.beatsin=0;a.y=0;a.sig2_=\n0;a.vol=0;a.certain=0;a.ran2_=0;a.beatcos=0;a.sig1_=0;a.q2=0;a.sig1=0;a.q14=0;a.maxind2=0;a.q3=0;a.reg00=0;a.vol_=0;a.m=0;a.trunner_=0;a.quad=0;a.ran1=0;a.q32=0;a.scheme=0;a.sbeat1=0;a.ran3_=0;a.maxi=0;a.a2=0;a.recsize=0;a.excite=0;a.change=0;a.stage=0;a.n=-1E4;for(var b=0;2E4>b;b++)a.megabuf[Math.floor(a.n)]=0,a.gmegabuf[Math.floor(a.n)]=0,a.n+=1;a.minbpm=60;a.maxbpm=320;a.num_res=200;for(b=a.index=0;b<a.num_res;b++)a.n=8*a.index,a.bpm=a.minbpm*pow(div(a.maxbpm,a.minbpm),div(a.index,a.num_res-1)),\na.megabuf[Math.floor(a.n)]=a.bpm,a.index+=1;a.pi=3.1416;a.ran1=rand(1);a.ran2=rand(1);a.ran3=rand(1);a.ran4=rand(1);","frame_eqs_str":"a['dt']=Math.min(div(1,a['fps']), 0.1); a['dec_m']=(1-(4*a['dt'])); a['dec_s']=(1-(1.25*a['dt'])); a['vol']=Math.max(0.5, (a['bass']+a['mid'])); a['vol_']=((a['vol_']*a['dec_m'])+((1-a['dec_m'])*a['vol'])); a['excite']=div((a['vol']-a['vol_']),a['vol_']); a['index']=0; a['ratio']=Math.log(div(a['maxbpm'],a['minbpm'])); a['sum_res']=0.01; for(var mdparser_idx3=0;mdparser_idx3<a['num_res'];mdparser_idx3++){a['n']=(a['index']*8); a['omega']=div((a['megabuf'][Math.floor(a['n'])]*6.2832),60); a['megabuf'][Math.floor((a['n']+1))]*=(1-(0.25*a['dt'])); a['ec_steps']=(Math.floor(((10*a['omega'])*a['dt']))+1); for(var mdparser_idx4=0;mdparser_idx4<a['ec_steps'];mdparser_idx4++){a['megabuf'][Math.floor((a['n']+1))]+=div(((a['excite']-(sqr(a['omega'])*a['megabuf'][Math.floor((a['n']+2))]))*a['dt']),a['ec_steps']); a['megabuf'][Math.floor((a['n']+2))]+=div((a['megabuf'][Math.floor((a['n']+1))]*a['dt']),a['ec_steps']);} a['beatcos']=a['megabuf'][Math.floor((a['n']+1))]; a['beatsin']=(a['megabuf'][Math.floor((a['n']+2))]*a['omega']); a['quad']=sqrt((pow(a['beatsin'], 2)+pow(a['beatcos'], 2))); a['megabuf'][Math.floor((a['n']+3))]=((a['megabuf'][Math.floor((a['n']+3))]*a['dec_s'])+(a['quad']*(1-a['dec_s']))); a['megabuf'][Math.floor((a['n']+4))]=a['megabuf'][Math.floor((a['n']+3))]; a['stage']=2; for(var mdparser_idx5=0;mdparser_idx5<2;mdparser_idx5++){a['ind2']=Math.floor(((0.5+a['index'])+(div((a['num_res']-1),a['ratio'])*Math.log(a['stage'])))); ((Math.abs(((a['ind2']<=a['num_res'])?1:0))>0.00001)?((function(){a['n2']=(a['ind2']*8); a['a2']=Math.max(Math.max(a['megabuf'][Math.floor((a['n2']+3))], a['megabuf'][Math.floor(((a['n2']-8)+3))]), a['megabuf'][Math.floor(((a['n2']+8)+3))]); return a['megabuf'][Math.floor((a['n']+4))]*=(1+div((div(2,(a['stage']*a['stage']))*a['a2']),(a['a2']+a['megabuf'][Math.floor((a['n']+3))])));})()):(0)); a['stage']*=2;} a['hyst']=(1+Math.min(0.25, (Math.abs((a['index']-a['maxind']))*0.02))); ((Math.abs(((a['megabuf'][Math.floor((a['n']+4))]>(a['megabuf'][Math.floor(((a['maxind']*8)+4))]*a['hyst']))?1:0))>0.00001)?(a['maxind']=a['index']):(0)); a['sum_res']+=a['megabuf'][Math.floor((a['n']+3))]; a['index']+=1;} a['certain']=div(a['megabuf'][Math.floor(((a['maxind']*8)+3))],div(a['sum_res'],a['num_res'])); a['maxind2']=Math.floor(((0.5+a['maxind'])+(div((a['num_res']-1),a['ratio'])*Math.log(2)))); ((Math.abs(((a['maxind2']>a['num_res'])?1:0))>0.00001)?(a['maxind2']=Math.floor(((0.5+a['maxind'])+(div((a['num_res']-1),a['ratio'])*Math.log(0.5))))):(0)); a['sig1']=(div((a['sig1']+a['megabuf'][Math.floor(((a['maxind']*8)+1))]),2)+(a['excite']*0)); a['is_beat1']=((((a['sig1']>0)?1:0)&&((a['sig1_']<=0)?1:0))?1:0); a['sig2']=(div((a['sig2']+a['megabuf'][Math.floor(((a['maxind2']*8)+1))]),2)+(a['excite']*0)); a['is_beat2']=((((a['sig2']>0)?1:0)&&((a['sig2_']<=0)?1:0))?1:0); a['fastpace']=((Math.abs(((a['maxind']>a['maxind2'])?1:0))>0.00001)?((((a['sig1']*a['sig1_'])<0)?1:0)):((function(){(((a['sig2']*a['sig2_'])<0)?1:0) a['sig1_']=a['sig1']; a['sig2_']=a['sig2']; a['tog1']=((a['sig1']>0)?1:0); a['tog2']=((a['sig2']>0)?1:0); a['sbeat1']=div((a['sbeat1']+a['is_beat1']),2); a['sbeat2']=div((a['sbeat2']+a['is_beat2']),2); a['prog1']=mod((a['prog1']+a['is_beat1']),512); a['prog2']=mod((a['prog2']+a['is_beat2']),512); a['prog3']=mod((a['prog3']+a['fastpace']),512); a['maxi']=Math.min(a['maxind'], a['maxind2']); a['trunner']=(a['trunner']+((div((a['dt']*a['megabuf'][Math.floor((a['maxi']*8))]),60)*2)*a['pi'])); a['corr']=((Math.abs(a['push'])>0.00001)?(((0.5*a['corr'])+(0.5*Math.cos(a['trunner'])))):((a['corr']*a['dec_s']))); a['trunner']-=(a['corr']*a['dt']); a['trunner_']=((a['dec_s']*a['trunner_'])+div(((1-a['dec_s'])*a['trunner']),2)); a['q14']=a['trunner_']; a['q15']=Math.cos(a['trunner_']); a['q16']=Math.sin(a['trunner_']); a['q32']=a['aspecty']; a['change']=((a['is_beat1']&&((Math.abs((mod(a['prog1'],20))-(0))<0.00001)?1:0))?1:0); return a['schange']=(((bnot(((Math.abs((a['oldind'])-(a['maxind']))<0.00001)?1:0))*((a['t1']>10)?1:0))||((a['t1']>30)?1:0))?1:0);})())); a['t1']=((Math.abs(a['schange'])>0.00001)?(0):((a['t1']+a['dt']))); a['oldind']=a['maxind']; a['ran1']=((Math.abs(a['change'])>0.00001)?(div(rand(100),100)):(a['ran1'])); a['ran2']=((Math.abs(a['change'])>0.00001)?(div(rand(100),100)):(a['ran2'])); a['ran3']=((Math.abs(a['change'])>0.00001)?(div(rand(100),100)):(a['ran3'])); a['ran4']=((Math.abs(a['change'])>0.00001)?(div(rand(100),100)):(a['ran4'])); a['ran1_']=(a['ran1_']+((Math.max(Math.min((a['ran1']-a['ran1_']), 0.02), -0.02)*a['dt'])*16)); a['ran2_']=(a['ran2_']+((Math.max(Math.min((a['ran2']-a['ran2_']), 0.02), -0.02)*a['dt'])*16)); a['ran3_']=(a['ran3_']+((Math.max(Math.min((a['ran3']-a['ran3_']), 0.02), -0.02)*a['dt'])*16)); a['ran4_']=(a['ran4_']+((Math.max(Math.min((a['ran4']-a['ran4_']), 0.1), -0.1)*a['dt'])*8)); a['scale']=sqrt(div(a['certain'],4)); a['q1']=a['prog1']; a['q2']=a['prog2']; a['q3']=a['prog3']; a['num_shapes']=8; a['reg00']=a['num_shapes']; a['recsize']=8; a['reg01']=a['recsize']; a['scheme']=((Math.abs(a['schange'])>0.00001)?(Math.floor(rand(3))):(a['scheme'])); a['m']=0; for(var mdparser_idx6=0;mdparser_idx6<(a['num_shapes']*((a['vol_']>0.7)?1:0));mdparser_idx6++){a['n']=(a['m']*a['recsize']); ((Math.abs(((Math.abs((a['scheme'])-(0))<0.00001)?1:0))>0.00001)?((function(){a['arg']=(a['q14']-((100*a['pi'])*Math.floor(div(div(a['q14'],100),a['pi'])))); a['x']=Math.sin(((div(((Math.abs(((a['ran3']>0.4)?1:0))>0.00001)?(a['arg']):(a['prog2'])),2)*(1+(4*a['ran1'])))*(div(a['m'],a['num_shapes'])-0.5))); a['gmegabuf'][Math.floor(a['n'])]=((a['x']*0.45)+0.5); a['y']=((2*(mod(a['m'],2)-0.5))*Math.max(Math.min((1.8*((Math.abs(((Math.abs((mod(a['m'],2))-(0))<0.00001)?1:0))>0.00001)?(Math.cos(a['arg'])):(Math.cos((a['arg']+(div(a['pi'],2)*((a['ran2']>0.5)?1:0))))))), 1), -1)); a['gmegabuf'][Math.floor((a['n']+1))]=(((((Math.abs(((a['ran4']>0.7)?1:0))>0.00001)?(Math.max(Math.min((6*Math.cos(div((a['x']*a['pi']),3))), 1), -1)):(1))*a['y'])*0.4)+0.5); return a['gmegabuf'][Math.floor((a['n']+4))]=bnot(a['schange']);})()):(0)); a['m']+=1;} a['m']=0; for(var mdparser_idx7=0;mdparser_idx7<(a['num_shapes']*((a['vol_']>0.7)?1:0));mdparser_idx7++){a['n']=(a['m']*a['recsize']); ((Math.abs(((Math.abs((a['scheme'])-(1))<0.00001)?1:0))>0.00001)?((function(){a['k1']=div(a['m'],a['num_shapes']); a['arg']=(div(a['prog3'],16)+(div(a['k1'],16)*Math.floor((((8*a['ran1'])-4)*a['ran1'])))); a['x']=((((Math.abs(((a['arg']-Math.floor(a['arg']))-0.5))-0.25)*4)*(mod(a['m'],2)-0.5))*2); a['y']=(((a['k1']-0.5)*2)*Math.sin((a['q14']+a['ran4']))); a['gmegabuf'][Math.floor(a['n'])]=((a['x']*0.48)+0.5); a['gmegabuf'][Math.floor((a['n']+1))]=((a['y']*0.48)+0.5); return a['gmegabuf'][Math.floor((a['n']+4))]=bnot(a['schange']);})()):(0)); a['m']+=1;} a['m']=0; for(var mdparser_idx8=0;mdparser_idx8<(a['num_shapes']*((a['vol_']>0.7)?1:0));mdparser_idx8++){a['n']=(a['m']*a['recsize']); ((Math.abs(((Math.abs((a['scheme'])-(2))<0.00001)?1:0))>0.00001)?((function(){a['k1']=div(a['m'],a['num_shapes']); a['arg']=div((((((a['q15']*a['q16'])*a['ran1'])*(((a['k1']*a['ran3'])*4)-2))+(div(a['q14'],a['pi'])*(1+((a['ran4']>0.8)?1:0))))+(a['ran2_']*4)),8); a['x']=((((Math.abs(((a['arg']-Math.floor(a['arg']))-0.5))-0.25)*4)*(mod(a['m'],2)-0.5))*2); a['y']=((((a['k1']-0.4)+((a['q15']*0.2)*a['ran2']))*2)*Math.sin((a['q14']+a['ran4']))); a['gmegabuf'][Math.floor(a['n'])]=((a['x']*0.48)+0.5); a['gmegabuf'][Math.floor((a['n']+1))]=((a['y']*0.48)+0.5); return a['gmegabuf'][Math.floor((a['n']+4))]=bnot(a['schange']);})()):(0)); a['m']+=1;} a['monitor']=a['scheme']; a['n']=0; for(var mdparser_idx9=0;mdparser_idx9<2000;mdparser_idx9++){a['gmegabuf'][Math.floor((a['n']+5000))]=a['megabuf'][Math.floor(a['n'])]; a['n']+=1;}","pixel_eqs_str":"a.zoom=.99;a.rot=0;a.warp=0;a.dy=-0;a.dx=0;a.zoom=1;a.dx=0;a.dy=0;","init_eqs_eel":"n = -10000; loop (20000, megabuf(n)=0; gmegabuf(n)=0; n +=1; );\n\nMINBPM = 60; MAXBPM = 320; num_res = 200; \nindex = 0;\nloop (num_res,\n  n = index*8;\n  BPM      = minbpm * pow(maxbpm/minbpm,index/(num_res-1));\n  megabuf(n) = BPM;\n  index += 1;\n);\n\n\n//structure of resonator data, starting at megabuf (0)\n//size = 8\n//0: BPM\n//1: v\n//2: y\n//3: amplitude\n//4: amplitude after harmonics post processing\n\n\n//structure of shapes data, starting at gmegabuf (0)\n//0: x\n//1: y\n//2:\n//3: rad\n//4: brightness\n\npi = 3.1416;\nran1 = rand(1);\nran2 = rand(1);\nran3 = rand(1);\nran4 = rand(1);","frame_eqs_eel":"//Martins resonant beat detection - use as it is\n//NOTE: uses megabuf (0) - megabuf (1600)\n//output: is_beat1 and is_beat2; 2:1 or 1:2\n\n//-------------- Start ----------------------------\ndt = min (1/fps,0.1) ; //Stability !\ndec_m = 1 - 4*dt; dec_s = 1 - 1.25*dt;\nvol =  max(0.5,bass+mid); \nvol_ = vol_*dec_m + (1-dec_m)*vol; excite = (vol-vol_)/vol_;\nindex=0; ratio = log(maxbpm/minbpm); sum_res = 0.01;\nloop (num_res,\n  n = index*8;\n  omega      =   megabuf(n) * 6.2832/60;\n  megabuf (n+1) *= 1-0.25*dt; //damping\n  EC_Steps = int (10*omega*dt)+1; \n  loop (EC_Steps, // Euler-Cauchy steps\n    megabuf (n+1) += (excite - sqr(omega)*megabuf(n + 2)) * dt/EC_Steps;\n    megabuf (n+2) += megabuf(n+1) * dt/EC_Steps);\n  beatcos  = megabuf(n+1);  beatsin = megabuf(n+2)*omega; //2pi/60\n  quad     = sqrt (pow(beatsin,2) + pow(beatcos,2)) ;\n  megabuf (n+3) = megabuf(n+3) *dec_s +  quad* (1-dec_s);\n  megabuf (n+4) = megabuf(n+3);\n  stage = 2; //Addition d. Harmonischen\n  loop (2,\n    ind2     = int (0.5 + index + (num_res-1)/ratio*log(stage));\n    if ((ind2 <= num_res),\n       n2 = ind2*8;\n       A2     = max(max(megabuf(n2+3),megabuf(n2-8+3)),megabuf(n2+8+3));\n      megabuf(n+4) *= 1 + 2/(stage*stage)*A2/(A2+megabuf(n+3)),0);\n    stage *= 2;\n  );\n  Hyst = 1 + min (0.25, abs (index-maxind)*0.02);\n  if (megabuf(n+4) > megabuf (maxind*8+4)*Hyst, maxind = index,0);\n  sum_res += megabuf (n+3);\n  index += 1;\n);\ncertain = megabuf(maxind*8+3)/(sum_res/num_res);\n//Doppelten oder, falls nicht moeglich, halben beat indizieren\nmaxind2     = int (0.5 + maxind + (num_res-1)/ratio*log(2));\nif (maxind2 > num_res, maxind2 = int (0.5 + maxind + (num_res-1)/ratio*log(0.5)),0);\nsig1 = (sig1 + megabuf(maxind*8+1))/2 + excite * 0; //check ######\nis_beat1  = (sig1 > 0) && (sig1_ <= 0); \nsig2 = (sig2 + megabuf(maxind2*8+1))/2 + excite * 0; //check ######\nis_beat2  = (sig2 > 0) && (sig2_ <= 0); \nfastpace = if (maxind > maxind2, sig1 * sig1_ < 0, sig2 * sig2_ < 0);\nsig1_ = sig1;\nsig2_ = sig2;\n//-------------- End ----------------------------\ntog1 = sig1 > 0;\ntog2 = sig2 > 0;\nsbeat1 = (sbeat1 + is_beat1)/2;\nsbeat2 = (sbeat2 + is_beat2)/2;\n//fastpace = if (maxind > ind2, is_beat1,is_beat2);\nprog1 = (prog1 + is_beat1) %512;\nprog2 = (prog2 + is_beat2) %512;\nprog3 = (prog3 + fastpace) %512;\n\nmaxi = min (maxind, maxind2);\n//maxi = maxind; //#####???\ntrunner = trunner + dt*megabuf (maxi*8)/60*2*pi;\ncorr = if (push, 0.5*corr + 0.5*cos (trunner), corr*dec_s);\ntrunner -= corr * dt;\ntrunner_ = dec_s * trunner_ + (1-dec_s)*trunner/2;\n\nq14 = trunner_;\nq15 = cos(trunner_);\nq16 = sin(trunner_);\n\nq32 = aspecty;\n//--------------------------------------------------------\nchange  = is_beat1 && (prog1%20 == 0);\nschange = bnot (oldind == maxind) * (t1 > 10) || (t1>30);\nt1 = if (schange, 0, t1+dt);\noldind = maxind;\n\nran1 = if (change, rand (100)/100, ran1);\nran2 = if (change, rand (100)/100, ran2);\nran3 = if (change, rand (100)/100, ran3);\nran4 = if (change, rand (100)/100, ran4);\nran1_ = ran1_ + max(min(ran1-ran1_,0.02),-0.02)*dt*16;\nran2_ = ran2_ + max(min(ran2-ran2_,0.02),-0.02)*dt*16;\nran3_ = ran3_ + max(min(ran3-ran3_,0.02),-0.02)*dt*16;\nran4_ = ran4_ + max(min(ran4-ran4_,0.1),-0.1)*dt*8;\n\nscale = sqrt (certain/4);\nq1 = prog1;\nq2 = prog2;\nq3 = prog3;\n\nnum_shapes = 8; reg00 = num_shapes;\nrecsize    = 8; reg01 = recsize;\n\nscheme = if (schange, int (rand(3)), scheme) ;\nm = 0; \nloop (num_shapes * (vol_> 0.7),\n  n = m*recsize;\n  if (scheme ==0,\n    arg = q14 - 100*pi*int(q14/100/pi); \n    x = sin(if (ran3 > 0.4,arg,prog2)/2 * (1+4*ran1) *(m/num_shapes-0.5));\n    gmegabuf (n) = x*0.45+0.5;\n    y = 2*(m%2-0.5) * max(min (1.8* if (m%2 == 0, cos(arg) ,cos(arg+pi/2*(ran2>0.5))),1),-1);\n    gmegabuf (n+1) = if (ran4 > 0.7, max(min(6*cos(x*pi/3),1),-1),1) * y * 0.4 + 0.5;\n    gmegabuf (n+4) = bnot(schange);;\n  ,0); //end if scheme ==1\nm += 1);\n\nm = 0; \nloop (num_shapes * (vol_> 0.7),\n  n = m*recsize;\n  if (scheme ==1,\n    k1 = m/num_shapes;\n    arg = (prog3)/16 + k1/16* int((8*ran1-4)*ran1) ;\n    x = (abs(arg-int(arg)-0.5)-0.25)*4 * (m%2-0.5)*2;\n    y =  (k1-0.5)*2*sin(q14+ran4) ;;\n\n    gmegabuf (n) =   x * 0.48 + 0.5;\n    gmegabuf (n+1) = y * 0.48 + 0.5;\n    gmegabuf (n+4) = bnot(schange);\n  ,0); //end if scheme ==1\nm += 1);\n\nm = 0; \nloop (num_shapes * (vol_> 0.7),\n  n = m*recsize;\n  if (scheme ==2,\n    k1 = m/num_shapes;\n    arg = (q15*q16*ran1*(k1*ran3*4-2)+q14/pi*(1+ (ran4>0.8))+ran2_*4)/8 ;\n    x = (abs(arg-int(arg)-0.5)-0.25)*4 * (m%2-0.5)*2;\n    y =  (k1-.4+q15*0.2*ran2)*2*sin(q14+ran4) ;;\n\n    gmegabuf (n) =   x * 0.48 + 0.5;\n    gmegabuf (n+1) = y * 0.48 + 0.5;\n    gmegabuf (n+4) = bnot(schange);;\n  ,0); //end if scheme ==1\nm += 1);\n\n\n\nmonitor = scheme;\nn = 0; loop (2000, gmegabuf(n+5000) = megabuf(n); n += 1);","pixel_eqs_eel":"zoom = .99; rot = 0; warp = 0; dy = -0.00;  dx = 0.00;\n\nzoom = 1; dx = 0; dy = 0;","warp":" shader_body { \n  vec4 tmpvar_1;\n  tmpvar_1.w = 1.0;\n  tmpvar_1.xyz = (texture (sampler_main, uv_orig).xyz * 0.4);\n  ret = tmpvar_1.xyz;\n }","comp":" shader_body { \n  vec4 tmpvar_1;\n  tmpvar_1.w = 1.0;\n  tmpvar_1.xyz = (clamp ((2.0 * \n    mix (texture (sampler_main, uv).xyz, ((texture (sampler_blur1, uv).xyz * scale1) + bias1), vec3(0.8, 0.8, 0.8))\n  ), 0.0, 1.0) * (2.0 * normalize(texture (sampler_noise_hq, \n    ((uv + (q2 / 4.0)) / 8.0)\n  ))).xyz);\n  ret = tmpvar_1.xyz;\n }","warp_hlsl":"#define sat saturate\nsampler sampler_pw_noise_lq;\nfloat3 color, mus;\nfloat2 uv1, uv2, uv3;\nfloat arg, arg2;\n\nfloat aTan2(float y, float x) {float angle;\t float abs_y = abs(y);\nif (x >= 0) {float r = (x - abs_y) / (x + abs_y); angle = 1-r;} \nelse {float r = (x + abs_y) / (abs_y - x); angle = 3-r; }\t\nreturn y < 0 ? -angle : angle;}\n\n\nshader_body {\n\nret = GetPixel (uv_orig)*0.4;\n}","comp_hlsl":"float3 Get1 (float2 uvi) {return lerp (GetPixel (uvi), GetBlur1(uvi), 0.8);}\n\n\nshader_body {\n//uv = mul (uv-0.5, float2x2 (q15,q16,-q16,q15))+0.5;\n// uv = (uv-0.5)*aspect.yx + 0.5;\n//uv = uv.yx;\n//uv = 1- abs( frac((uv-.5)*1.5 * 0.5 ) * 2 - 1.0 ); // Eo.S. mirror code\n\n//uv = float2 (abs(uv.x-0.5), uv.y);\n//uv = float2 (uv.x, abs(uv.y-0.5)*2);\n\nret = saturate(2*Get1 (uv));\n//ret = max (Get1(uv), Get1 (1-uv/2));\n\nret *= 2*normalize ((tex2D (sampler_noise_hq,(uv+q2/4)/8)) + 0);\n\n\n//ret *= (hue_shader *5 -4)*2;\n}\n"}